Выдача книги читателю

Процесс:
1. Идентификация читателя
Читатель предъявляет библиотекарю свой читательский билет с QR-кодом
Библиотекарь сканирует QR-код с помощью системы ИСБ
ИСБ извлекает ID аккаунта из QR-кода через метод ScanQRCode()
2. Проверка статуса аккаунта
ИСБ вызывает метод CheckStatus(id) у объекта Account
Account проверяет, имеет ли статус значение "Active"
Account возвращает результат проверки (true/false)
3. Поиск книги в каталоге
Библиотекарь сообщает название и автора нужной книги
ИСБ вызывает метод SearchBooks(title, author) у Catalog
Catalog осуществляет поиск через иерархию компонентов (Cabinet → Shelf → Cell)
Catalog возвращает список найденных книг с информацией о доступных экземплярах
4. Проверка возможности выдачи
ИСБ вызывает метод CanBorrowMore() у Account
Account последовательно проверяет:
Вызывает HasOverdueBooks() - проверяет наличие просроченных книг
Вызывает HasUnpaidFines() - проверяет наличие неуплаченных штрафов
Проверяет статус аккаунта ("Active")
Проверяет не превышен ли лимит книг (максимум 5)
Account возвращает true, если все проверки пройдены
5. Поиск конкретного экземпляра
ИСБ вызывает метод FindBook(bookId) у Catalog
Catalog ищет конкретный экземпляр книги среди BookInstances
Catalog возвращает объект BookLocation с информацией о местоположении и доступности
6. Создание записи о займе
ИСБ вызывает метод CreateLoan() у Account с параметрами:
accountId - ID аккаунта
bookItemId - ID экземпляра книги
issueDate - дата выдачи (текущая дата)
dueDate - дата возврата (текущая дата + 14 дней)
Account создает объект Loan через конструктор
Конструктор Loan генерирует уникальный ID и сохраняет все переданные данные
Account возвращает созданный объект Loan в ИСБ
7. Обновление состояния аккаунта
ИСБ вызывает метод AddLoan(loanId) у Account
Account увеличивает счетчик CurrentLoans на 1
ИСБ добавляет bookId в список BooksOnHand аккаунта
ИСБ сохраняет займ в словарь activeLoans
8. Завершение процесса
ИСБ возвращает подтверждение библиотекарю
Библиотекарь выдает физический экземпляр книги читателю
```
@startuml

actor Visitor
actor Librarian
participant "ISB" as System
participant "Account" as Account
participant "Catalog" as Catalog
participant "ReservationQueue" as Queue
participant "Reservation" as Reservation
participant "Loan" as Loan

Visitor -> Librarian : предъявляет читательский билет

Librarian -> System : сканирует qr-code
activate System

System -> Account : CheckStatus(id): Boolean
activate Account
Account --> System : статус: активен
deactivate Account

System -> Catalog : SearchBooks(title, author)
activate Catalog
Catalog --> System : экземпляры книги
deactivate Catalog

System -> Account : CanBorrowMore(): Boolean
activate Account
Account -> Account : HasOverdueBooks()
Account -> Account : HasUnpaidFines()
Account --> System : может брать книги: true
deactivate Account

System -> Catalog : FindBook(bookId)
activate Catalog
Catalog --> System : BookLocation
deactivate Catalog

System -> Account : CreateLoan(accountId, bookItemId, issueDate, dueDate)
activate Account
Account -> Loan : new Loan(accountId, bookItemId, issueDate, dueDate)
activate Loan
Loan --> Account : Loan объект
deactivate Loan
Account --> System : Loan объект
deactivate Account

System -> Account : AddLoan(loanId)
activate Account
Account --> System : подтверждение
deactivate Account

System -> Account : BooksOnHand.Add(bookId)
activate Account
Account --> System : подтверждение
deactivate Account

System -> System : activeLoans.Add(loan.Id, loan)

Librarian <- System : подтверждение выдачи
deactivate System

Librarian -> Visitor : выдает книги

@enduml
```
<img width="1400" height="890" alt="image" src="https://github.com/user-attachments/assets/2d8940fa-72df-4404-9ed6-92f283769f83" />
