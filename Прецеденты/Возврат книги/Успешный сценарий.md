Возврат книги

1. Инициация возврата
Процесс возврата обычно начинается, когда пользователь приносит книгу обратно в библиотеку. Оператор системы (или сам пользователь через интерфейс) инициирует возврат, указывая идентификатор книги (bookId) или идентификатор экземпляра книги (bookItemId).

2. Проверка наличия активного займа (CheckReturnBook)
Сначала система проверяет, существует ли активный займ на указанную книгу и не просрочен ли он.
Класс: ISB
Метод: CheckReturnBook(string bookId)
Что делает:
Ищет в словаре activeLoans запись, где loan.BookItemId == bookId.
Если такой займ найден:
Вычисляет количество дней просрочки:
Возвращает true, если книга просрочена (daysOverdue > 0), иначе — false.
Если займ не найден — возвращает false.

3. Обновление статуса книги и аккаунта (UpdateReturnBook)
Если книга действительно находится у читателя, система завершает процесс возврата.
Класс: ISB
Метод: UpdateReturnBook(string bookId)
Что делает:
Поиск займа по bookId:
Если займ найден:
Получает объект аккаунта:
Удаляет книгу из списка книг на руках у пользователя:
Удаляет займ из списка активных:
Результат: книга официально возвращена, аккаунт пользователя обновлён.



4. Уведомление следующего в очереди резерваций (не автоматизировано)
Если на возвращённую книгу есть резервации, должен сработать механизм уведомления следующего в очереди.
Класс: ReservationQueue
Метод: NotifyNextReader()
Что делает:
Находит первую активную резервацию (Status == "Active").
Выводит уведомление (в реальной системе — отправка email/SMS).


5. Проверка и начисление штрафов
Хотя в коде есть метод Account.HasUnpaidFines(), логика начисления штрафов за просрочку не реализована.
При возврате проверяется daysOverdue.
Если daysOverdue > 0, создаётся запись о штрафе.
Аккаунт блокируется от новых займов, пока штраф не оплачен.
```
@startuml

actor Читатель
actor Библиотекарь
participant "ИСБ" as ISB
participant "Учетная запись" as Account
participant "Каталог" as Catalog



Читатель -> Библиотекарь : показывает qr-code

activate ISB

Библиотекарь -> ISB : returnBook(id_book)

alt Если просрочил книгу

ISB -> Account : createLoan(user_id, bookItemId, issueDate, dueDate)
activate Account
deactivate Account

end

ISB -> ISB: updateReturnBook(id_book)
ISB -> Библиотекарь:

Библиотекарь -> ISB: searchBooks(title, author)


/'System -> Account : changeUserStatus(userId, bookId)'/
/'activate Account'/
/'System -> Catalog : changeBookStatus(bookId)'/
/'deactivate Account'/
/'activate Catalog'/
/'System -> Catalog : getShelfNum(bookId)'/
/'System <- Catalog : номер полки'/
/'deactivate Catalog'/
/'Библиотекарь <- System : номер полки'/
/'deactivate ISB'/

@enduml

```
