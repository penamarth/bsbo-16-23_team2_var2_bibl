<img width="1585" height="2023" alt="image" src="https://github.com/J9djtl/taski/blob/main/last.png" />

```
@startuml
package "Application Services" {
  class ISB {
    - accounts: Map<String, Account>
    - reservationQueues: Map<String, ReservationQueue>
    - activeLoans: Map<String, Loan>
    - catalog: Catalog
    - notificationService: Notification
    + registerAccount(fullName: String, phone: String, email: String): Account
    + authenticate(login: String, password: String): Account
    + searchBooks(title: String, author: String): List<Book>
    + reserveBook(accountId: String, bookId: String): Reservation
    + issueBook(accountId: String, bookId: String, issueDate: Date, dueDate: Date): Loan
    + checkReturnBook(id_book: String): boolean
    + updateReturnBook(id_book: String)
    + getUserInfo(id: String): Account
    + scanQRCode(qrData: String): String
    + tryFindAccount(id: String): boolean
    + getActiveLoans(): Map<String, Loan>
  }
}

package "Patron Context" {
  class Account{
    - id: String
    - fullName: String
    - phone: String
    - email: String
    - status: String
    - currentLoans: int
    - BooksOnHand: List<String>
    - currentReservations: List<String>
    + hasOverdueBooks(): boolean
    + hasUnpaidFines(): boolean
    + canBorrowMore(): boolean
    + addLoan(loanId: String): void
    + addReservation(reservationId: String): void
    + getFullName(): String
    + getPhone(): String
    + getEmail(): String
    + getId(): String
    + getStatus(): String
    + checkStatus(id: int): Boolean
    + setStatus(status: String)
    + createLoan(accountId: String, bookItemId: String, issueDate: Date, dueDate: Date): Loan
  }
}

package "Catalog Context" {
  interface Component {
    + {abstract} findAvailableLocation(): Component
    + {abstract} searchBooks(title: String, author: String): List<BookInfo>
  }

  class Catalog implements Component {
    - books: List<Book>
    + searchBooks(title: String, author: String): List<BookInfo>
    + findBook(bookId: String): BookLocation
    + findAvailableLocation(): Component
    + getBookLocation(bookItemId: String): Component
  }

  class Cabinet implements Component {
    - children: List<Shelf>
    + findAvailableLocation(): Component
    + placeBook(book: BookInstance): boolean
    + searchBooks(title: String, author: String): List<BookInfo>
  }

  class Shelf implements Component {
    - children: List<Cell>
    + findAvailableLocation(): Component
    + placeBook(book: BookInstance): boolean
    + searchBooks(title: String, author: String): List<BookInfo>
  }

  class Cell implements Component {
    - bookItem: BookInstance
    + findAvailableLocation(): Component
    + placeBook(book: BookInstance): boolean
    + searchBooks(title: String, author: String): List<BookInfo>
  }

  class Book {
    - id: String
    - title: String
    - author: String
    - year: int
    - description: String
    - currentReservations: List<String>
    - books_available: List<String>
  }

  class BookInstance {
    - id: String
    - id_book: String
    - status: String
    - location: Component
    - userId: String
    - returnDate: Date
    + updateStatus(status: String): void
    + isAvailable(): boolean
  }
}

package "Circulation Context" {
  class ReservationQueue {
    - bookId: String
    - reservations: List<Reservation>
    + addReservation(accountId: String, bookId: String): String
    + getNextReservation(): Reservation
    + getPosition(accountId: String): int
    + notifyNextReader(): void
  }

  class Reservation {
    - id: String
    - accountId: String
    - bookId: String
    - createDate: Date
    - status: String
    - expiryDate: Date
    + cancel(): void
    + fulfill(): void
  }

  class Loan {
    - id: String
    - accountId: String
    - bookItemId: String
    - issueDate: Date
    - dueDate: Date
    + Loan(accountId: String, bookItemId: String, issueDate: Date, dueDate: Date)
  }
}

' Connections
ISB --> Account
ISB --> ReservationQueue
ISB --> Component
Account --> Loan
Account --> Reservation
Catalog *--> Cabinet
Cabinet *--> Shelf
Shelf *--> Cell
Cell --> BookInstance
BookInstance --> Book
ReservationQueue --> Reservation

@enduml
```
